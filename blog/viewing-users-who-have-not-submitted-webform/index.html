<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML+RDFa 1.0//EN"
  "http://www.w3.org/MarkUp/DTD/xhtml-rdfa-1.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" version="XHTML+RDFa 1.0" dir="ltr"
  xmlns:content="http://purl.org/rss/1.0/modules/content/"
  xmlns:dc="http://purl.org/dc/terms/"
  xmlns:foaf="http://xmlns.com/foaf/0.1/"
  xmlns:og="http://ogp.me/ns#"
  xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
  xmlns:sioc="http://rdfs.org/sioc/ns#"
  xmlns:sioct="http://rdfs.org/sioc/types#"
  xmlns:skos="http://www.w3.org/2004/02/skos/core#"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema#">


<!-- Mirrored from theoleschool.com/blog/viewing-users-who-have-not-submitted-webform by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 26 Sep 2015 17:07:17 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head profile="http://www.w3.org/1999/xhtml/vocab">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="description" content="On a recent Drupal 6 site, I received a request to build a view displaying a list of users who had not submitted a specific webform." />
<link rel="shortcut icon" href="../../misc/favicon/index.ico" type="image/vnd.microsoft.icon" />
<meta content="Viewing Users Who Have Not Submitted a Webform" about="/blog/viewing-users-who-have-not-submitted-webform" property="dc:title" />
<meta name="keywords" content="drupal, web development" />
<link rel="canonical" href="index.html" />
<link rel="shortlink" href="index.html" />
<meta name="generator" content="Drupal 7 (http://drupal.org)" />
  <title>Viewing Users Who Have Not Submitted a Webform | theoleschool</title>
  <link type="text/css" rel="stylesheet" href="../../sites/default/files/css/css_pbm0lsQQJ7A7WCCIMgxLho6mI_kBNgznNUWmTWcnfoE/index.css" media="all" />
<link type="text/css" rel="stylesheet" href="../../sites/default/files/css/css_botNHIYRQPys-RH2iA3U4LbV9bPNRS64tLAs8ec1ch8/index.css" media="all" />
<link type="text/css" rel="stylesheet" href="../../sites/default/files/css/css_ggwmJjnSHIyQGr6BcS46i7z-SeJR7vFJ2H8b7fsUJ1o/index.css" media="all" />
<link type="text/css" rel="stylesheet" href="../../sites/default/files/css/css_wTnXwKLp1ec_eSA6aRSbc1Cr7mXlDTPbLelDm9ZTjQg/index.css" media="screen" />
  <script type="text/javascript" src="../../sites/default/files/js/js_xAPl0qIk9eowy_iS9tNkCWXLUVoat94SQT48UBCFkyQ/index.js"></script>
<script type="text/javascript" src="../../sites/default/files/js/js_mEEqrZApHAidJyywsmZR_Ac1d4B-4FLzvR9sbsjVDyg/index.js"></script>
<script type="text/javascript" src="../../sites/default/files/js/js_IDBX5SzkJ9gGNq7x-qOE_2DZsexqguTJQGMKvi4w-Uw/index.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
var _gaq = _gaq || [];_gaq.push(["_setAccount", "UA-25692833-1"]);_gaq.push(["_trackPageview"]);(function() {var ga = document.createElement("script");ga.type = "text/javascript";ga.async = true;ga.src = "../../sites/default/files/googleanalytics/ga/index.js?nvammp";var s = document.getElementsByTagName("script")[0];s.parentNode.insertBefore(ga, s);})();
//--><!]]>
</script>
<script type="text/javascript" src="../../sites/default/files/js/js_ix99IaKNwg4XQrjVLFsrlxH0Czfb_Wvr8_P-vBK2zQU/index.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"","ajaxPageState":{"theme":"olesain","theme_token":"a-CbhoSvM5-v88uPQeChPe7_6eR0SF_Rtl74VnqMtds","js":{"misc\/jquery.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"sites\/all\/modules\/admin_menu\/admin_devel\/admin_devel.js":1,"sites\/all\/modules\/google_analytics\/googleanalytics.js":1,"0":1,"sites\/all\/modules\/disqus\/disqus.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"modules\/user\/user.css":1,"sites\/all\/modules\/views\/css\/views.css":1,"sites\/all\/modules\/ctools\/css\/ctools.css":1,"sites\/all\/modules\/geshifilter\/geshifilter.css":1,"sites\/default\/themes\/olesain\/css\/reset.css":1,"sites\/default\/themes\/olesain\/css\/style.css":1}},"googleanalytics":{"trackOutbound":1,"trackMailto":1,"trackDownload":1,"trackDownloadExtensions":"7z|aac|arc|arj|asf|asx|avi|bin|csv|doc|exe|flv|gif|gz|gzip|hqx|jar|jpe?g|js|mp(2|3|4|e?g)|mov(ie)?|msi|msp|pdf|phps|png|ppt|qtm?|ra(m|r)?|sea|sit|tar|tgz|torrent|txt|wav|wma|wmv|wpd|xls|xml|z|zip"},"disqus":{"domain":"Theoleschool","url":"http:\/\/theoleschool.com\/blog\/viewing-users-who-have-not-submitted-webform","title":"Viewing Users Who Have Not Submitted a Webform","identifier":"node\/158"}});
//--><!]]>
</script>
</head>
<body class="html not-front not-logged-in no-sidebars page-node page-node- page-node-158 node-type-article" >
  <div id="skip-link">
    <a href="#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
    <div id="center-col">
  <!--  Main Content Container -->
  <div id="main-wrap">
    <div class="content-wrap">
              <div class="region region-content">
    <div id="block-system-main" class="block block-system">

    
  <div class="content">
    <div id="node-158" class="node node-article node-promoted clearfix">
      <div class="meta clearfix">
      <div class="auth">March 4, 2012</div>
      <div class="created">12:25pm</div>
    </div>
  
    <h2 class="node-title">Viewing Users Who Have Not Submitted a Webform</h2>    <div class="tags clearfix"><div class="field field-name-field-blog-tags field-type-taxonomy-term-reference field-label-hidden"><div class="field-items"><div class="field-item even"><a href="../../tags/views/" typeof="skos:Concept" property="rdfs:label skos:prefLabel" datatype="">views</a></div><div class="field-item odd"><a href="../../tags/6x/" typeof="skos:Concept" property="rdfs:label skos:prefLabel" datatype="">6.x</a></div><div class="field-item even"><a href="../../tags/drupal/" typeof="skos:Concept" property="rdfs:label skos:prefLabel" datatype="">drupal</a></div></div></div></div>

        <div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even" property="content:encoded"><p>On a recent Drupal 6 site, I received a request to build a view displaying a list of users who had not submitted a specific webform.  <a href="http://drupal.org/project/webform"">Webform</a> of course, has some very nice reporting as well as decent views integration for submissions.  However, to view users that have yet to make a submission takes some creative views argument handling.</p>
<p>I began by building a basic user view.  I then set the style and fields to my liking, and filtered on the specific role I was looking for.  So now we have views pulling a list of users that we wish to check against.  To find out who has not submitted the webform, we first have to take a look at who has.</p> 
<div class="geshifilter"><div class="drupal6 geshifilter-drupal6" style="font-family:monospace;">webform_get_submissions<span style="color: #66cc66;">(</span><span style="color: #0000ff;">$filters</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">(</span><span style="color: #66cc66;">)</span>, <span style="color: #0000ff;">$header</span> = <span style="color: #000000; font-weight: bold;">NULL</span>, <span style="color: #0000ff;">$pager_count</span> = <span style="color: #cc66cc;">0</span><span style="color: #66cc66;">)</span>;</div></div>
<p>Webform has the above function in the <span class="geshifilter"><code class="php geshifilter-php">webform<span style="color: #339933;">.</span>submission<span style="color: #339933;">.</span>inc</code></span> file that does just this.  You can pass a node id to <span class="geshifilter"><code class="php geshifilter-php"><span style="color: #000088;">$filters</span></code></span> and the function will return a nice array of submission objects, detailing who has submitted the form.  We can then add an argument of type <em>"User: UID"</em> to our view, select <em>"Provide default argument"</em> below "Action to take if argument is not present," and select <em>"PHP Code"</em> under "Default argument type."  Here we can provide a code snippet to return a list of User ids of users that have submitted the form.
</p><div class="geshifilter"><div class="drupal6 geshifilter-drupal6" style="font-family:monospace;"><a href="http://api.drupal.org/api/function/module_load_include/6"><span style="color: #000066;">module_load_include</span></a><span style="color: #66cc66;">(</span><span style="color: #ff0000;">'inc'</span>, <span style="color: #ff0000;">'webform'</span>, <span style="color: #ff0000;">'includes/webform.submissions'</span><span style="color: #66cc66;">)</span>;<br /><span style="color: #0000ff;">$submission_array</span> = webform_get_submissions<span style="color: #66cc66;">(</span><span style="color: #808080; font-style: italic;">/*node id of webform we are checking for*/</span><span style="color: #66cc66;">)</span>;<br /><span style="color: #0000ff;">$uids</span> = <a href="http://www.php.net/array"><span style="color: #000066;">array</span></a><span style="color: #66cc66;">(</span><span style="color: #66cc66;">)</span>;<br /><span style="color: #b1b100;">foreach</span><span style="color: #66cc66;">(</span><span style="color: #0000ff;">$submission_array</span> <span style="color: #b1b100;">as</span> <span style="color: #0000ff;">$submission</span><span style="color: #66cc66;">)</span> <span style="color: #66cc66;">{</span><br />
Â  <span style="color: #0000ff;">$uids</span><span style="color: #66cc66;">[</span><span style="color: #66cc66;">]</span> = <span style="color: #0000ff;">$submission</span>-<span style="color: #66cc66;">&gt;</span><span style="color: #006600;">uid</span>;<br /><span style="color: #66cc66;">}</span><br /><span style="color: #b1b100;">return</span> <a href="http://www.php.net/implode"><span style="color: #000066;">implode</span></a><span style="color: #66cc66;">(</span><span style="color: #ff0000;">','</span>, <span style="color: #0000ff;">$uids</span><span style="color: #66cc66;">)</span>;</div></div>
<p>This will gives us a comma separated string of user ids.  The default "Validator options" are fine but <strong>be sure</strong> to check <em>"Allow multiple terms per argument"</em> and <em>"Exclude the argument."</em>  After updating, your view now filters down to users that have not submitted the webform! To double check that this is happening, you can look at the query below the preview.  Near the end of the query in the <span class="geshifilter"><code class="sql geshifilter-sql"><span style="color: #993333; font-weight: bold;">WHERE</span></code></span> clause, you should see something like <span class="geshifilter"><code class="sql geshifilter-sql">users<span style="color: #66cc66;">.</span>uid <span style="color: #993333; font-weight: bold;">NOT</span> <span style="color: #993333; font-weight: bold;">IN</span> <span style="color: #66cc66;">(</span><span style="color: #cc66cc;">110</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">13028</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">210</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">107</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">35329</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">35330</span><span style="color: #66cc66;">,</span> <span style="color: #cc66cc;">35331</span><span style="color: #66cc66;">)</span></code></span>. The list of numbers are the user ids that are being filtered.  If no one has submitted the form, then this of course will be empty.</p>
<p>Now I admit, this is kinda gross. I shudder any time I include php in configuration. It is, however, a very straight forward way to get the results requested while staying in views, therefore leaving the output in the hands of a site builder/administrator.  There may be some clever ways to achieve the same thing using something like <a href="http://drupal.org/project/webform_report">Webform Report</a>, or even a different views configuration, but nothing jumped out at me.  However, if you have solved this in a different way I would love to hear about it.</p></div></div></div><div id="disqus_thread"><noscript><p><a href="http://theoleschool.disqus.com/?url=http%3A%2F%2Ftheoleschool.com%2Fblog%2Fviewing-users-who-have-not-submitted-webform">View the discussion thread.</a></p></noscript></div>
    <div class="meta clearfix">
      </div>
  <div class="olesain-comments clearfix">
          </div>
</div>  </div>
</div>
  </div>
    </div>
  </div>
</div>
<!-- Header -->
<div id="meta-header" class="clearfix">
  <div class="header-content">
    <h1 class="logo"><a href="../../">
      <span class="name">Ryan Oles</span>
      <span class="name site-name">the<span class="color-orng">oles</span>chool.com</span>
    </a></h1>
        <!-- Navigation -->
          <div id="main-menu" class="top-nav clearfix">
        <h2 class="element-invisible">Main menu</h2><ul id="main-menu-nav" class="links clearfix"><li class="menu-345 first"><a href="../../about/">About</a></li>
<li class="menu-275 last"><a href="../../" title="go back to front page">Home</a></li>
</ul>      </div>
      </div>
</div>  </body>

<!-- Mirrored from theoleschool.com/blog/viewing-users-who-have-not-submitted-webform by HTTrack Website Copier/3.x [XR&CO'2014], Sat, 26 Sep 2015 17:07:18 GMT -->
</html>
