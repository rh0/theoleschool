<?xml version="1.0" encoding="utf-8"?>
<rss version="2.0" xml:base="http://theoleschool.com"  xmlns:dc="http://purl.org/dc/elements/1.1/">
<channel>
 <title>theoleschool - commerce</title>
 <link>http://theoleschool.com/tags/commerce</link>
 <description></description>
 <language>en</language>
<item>
 <title>Templating the Commerce Order Completion Pane</title>
 <link>http://theoleschool.com/blog/templating-commerce-order-completion-pane</link>
 <description>&lt;div class=&quot;field field-name-body field-type-text-with-summary field-label-hidden&quot;&gt;&lt;div class=&quot;field-items&quot;&gt;&lt;div class=&quot;field-item even&quot; property=&quot;content:encoded&quot;&gt;&lt;p&gt;I recently found myself working on a fairly simple Drupal Commerce site.  There weren&#039;t a lot of tricks to it, just a few items and an &quot;express&quot; checkout.  So I fired up the &lt;a href=&quot;http://drupal.org/project/commerce_kickstart&quot;&gt;Commerce Kickstart&lt;/a&gt; profile and after a few small tweaks, had it just about right.  As we approached the theme, it became obvious that the commerce completion pane was going to take a lot of love.  The designers had given us a unique layout for how this page should appear, complete with order specific information displayed in a kaleidoscope of containers.  This was going to take some markup, and my first thought was, &quot;it sure would be nice to template this.&quot;&lt;/p&gt;&lt;!--break--&gt;
&lt;p&gt;Turns out that&#039;s a fairly simple task thanks to &lt;a href=&quot;http://api.drupalcommerce.org/api/Drupal%20Commerce/sites!all!modules!commerce!modules!checkout!commerce_checkout.api.php/function/hook_commerce_checkout_pane_info_alter/DC&quot;&gt;hook_commerce_checkout_pane_info_alter&lt;/a&gt;.  The function passes the variable &lt;span class=&quot;geshifilter&quot;&gt;&lt;code class=&quot;php geshifilter-php&quot;&gt;&lt;span style=&quot;color: #000088;&quot;&gt;$checkout_panes&lt;/span&gt;&lt;/code&gt;&lt;/span&gt; by reference which contains an array of checkout pane arrays.  This function is going to allow us to redefine the function that the checkout completion pane is looking to for output.  This will look something like:&lt;/p&gt;
&lt;div class=&quot;geshifilter&quot;&gt;&lt;div class=&quot;drupal6 geshifilter-drupal6&quot; style=&quot;font-family:monospace;&quot;&gt;&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;function&lt;/span&gt; my_module_commerce_checkout_pane_info_alter&lt;span style=&quot;color: #66cc66;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;$checkout_panes&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;)&lt;/span&gt; &lt;span style=&quot;color: #66cc66;&quot;&gt;{&lt;/span&gt;&lt;br /&gt;
  &lt;span style=&quot;color: #b1b100;&quot;&gt;if&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;(&lt;/span&gt;&lt;a href=&quot;http://www.php.net/isset&quot;&gt;&lt;span style=&quot;color: #000066;&quot;&gt;isset&lt;/span&gt;&lt;/a&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;$checkout_panes&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #ff0000;&quot;&gt;&#039;checkout_completion_message&#039;&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;)&lt;/span&gt; &lt;span style=&quot;color: #66cc66;&quot;&gt;{&lt;/span&gt;&lt;br /&gt;
    &lt;span style=&quot;color: #808080; font-style: italic;&quot;&gt;// forget the original include file                     &lt;/span&gt;&lt;br /&gt;
    &lt;a href=&quot;http://www.php.net/unset&quot;&gt;&lt;span style=&quot;color: #000066;&quot;&gt;unset&lt;/span&gt;&lt;/a&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;$checkout_panes&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #ff0000;&quot;&gt;&#039;checkout_completion_message&#039;&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #ff0000;&quot;&gt;&#039;file&#039;&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;)&lt;/span&gt;;&lt;br /&gt;
    &lt;span style=&quot;color: #808080; font-style: italic;&quot;&gt;// point at this module&lt;/span&gt;&lt;br /&gt;
    &lt;span style=&quot;color: #0000ff;&quot;&gt;$checkout_panes&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #ff0000;&quot;&gt;&#039;checkout_completion_message&#039;&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #ff0000;&quot;&gt;&#039;module&#039;&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;]&lt;/span&gt; = &lt;span style=&quot;color: #ff0000;&quot;&gt;&#039;my_module&#039;&lt;/span&gt;;&lt;br /&gt;
    &lt;span style=&quot;color: #808080; font-style: italic;&quot;&gt;// register the new output function&lt;/span&gt;&lt;br /&gt;
    &lt;span style=&quot;color: #0000ff;&quot;&gt;$checkout_panes&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #ff0000;&quot;&gt;&#039;checkout_completion_message&#039;&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;]&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #ff0000;&quot;&gt;&#039;base&#039;&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;]&lt;/span&gt; = &lt;span style=&quot;color: #ff0000;&quot;&gt;&#039;my_module_completion_message_pane&#039;&lt;/span&gt;;&lt;br /&gt;
  &lt;span style=&quot;color: #66cc66;&quot;&gt;}&lt;/span&gt;&lt;br /&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The function name we passed above will have &lt;span class=&quot;geshifilter&quot;&gt;&lt;code class=&quot;php geshifilter-php&quot;&gt;_checkout_form&lt;/code&gt;&lt;/span&gt; appended.  We will need to declare a function to satisfy this  and return our output.&lt;/p&gt;
&lt;div class=&quot;geshifilter&quot;&gt;&lt;div class=&quot;drupal6 geshifilter-drupal6&quot; style=&quot;font-family:monospace;&quot;&gt;&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;function&lt;/span&gt; my_module_completion_message_pane_checkout_form&lt;span style=&quot;color: #66cc66;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;$form&lt;/span&gt;, &lt;span style=&quot;color: #66cc66;&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;$form_state&lt;/span&gt;, &lt;span style=&quot;color: #0000ff;&quot;&gt;$checkout_pane&lt;/span&gt;, &lt;span style=&quot;color: #0000ff;&quot;&gt;$order&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;)&lt;/span&gt; &lt;span style=&quot;color: #66cc66;&quot;&gt;{&lt;/span&gt;&lt;br /&gt;
  &lt;span style=&quot;color: #0000ff;&quot;&gt;$pane_form&lt;/span&gt; = &lt;a href=&quot;http://www.php.net/array&quot;&gt;&lt;span style=&quot;color: #000066;&quot;&gt;array&lt;/span&gt;&lt;/a&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;)&lt;/span&gt;;&lt;br /&gt;
  &lt;span style=&quot;color: #0000ff;&quot;&gt;$pane_form&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #ff0000;&quot;&gt;&#039;message&#039;&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;]&lt;/span&gt; = &lt;a href=&quot;http://www.php.net/array&quot;&gt;&lt;span style=&quot;color: #000066;&quot;&gt;array&lt;/span&gt;&lt;/a&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #ff0000;&quot;&gt;&#039;#markup&#039;&lt;/span&gt; =&lt;span style=&quot;color: #66cc66;&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&quot;color: #808080; font-style: italic;&quot;&gt;/*markup*/&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;)&lt;/span&gt;;&lt;br /&gt;
  &lt;span style=&quot;color: #b1b100;&quot;&gt;return&lt;/span&gt; &lt;span style=&quot;color: #0000ff;&quot;&gt;$pane_form&lt;/span&gt;;&lt;br /&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;From here, we&#039;re basically home free.  We simply need to replace &lt;span class=&quot;geshifilter&quot;&gt;&lt;code class=&quot;php geshifilter-php&quot;&gt;&lt;span style=&quot;color: #666666; font-style: italic;&quot;&gt;/*markup*/&lt;/span&gt;&lt;/code&gt;&lt;/span&gt; with the output we desire.  Since we are looking to template this, we will need to register a theme implementation for it.  The important thing to note is the &lt;span class=&quot;geshifilter&quot;&gt;&lt;code class=&quot;php geshifilter-php&quot;&gt;&lt;span style=&quot;color: #000088;&quot;&gt;$order&lt;/span&gt;&lt;/code&gt;&lt;/span&gt; variable passed to this function.  We&#039;ll need that order information in our template, so we pass it along while laying out our &lt;span class=&quot;geshifilter&quot;&gt;&lt;code class=&quot;php geshifilter-php&quot;&gt;hook_theme&lt;/code&gt;&lt;/span&gt; call.&lt;/p&gt;
&lt;div class=&quot;geshifilter&quot;&gt;&lt;div class=&quot;drupal6 geshifilter-drupal6&quot; style=&quot;font-family:monospace;&quot;&gt;&lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;function&lt;/span&gt; my_module_theme&lt;span style=&quot;color: #66cc66;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;$existing&lt;/span&gt;, &lt;span style=&quot;color: #0000ff;&quot;&gt;$type&lt;/span&gt;, &lt;span style=&quot;color: #0000ff;&quot;&gt;$theme&lt;/span&gt;, &lt;span style=&quot;color: #0000ff;&quot;&gt;$path&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;)&lt;/span&gt; &lt;span style=&quot;color: #66cc66;&quot;&gt;{&lt;/span&gt;&lt;br /&gt;
  &lt;span style=&quot;color: #b1b100;&quot;&gt;return&lt;/span&gt; &lt;a href=&quot;http://www.php.net/array&quot;&gt;&lt;span style=&quot;color: #000066;&quot;&gt;array&lt;/span&gt;&lt;/a&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;(&lt;/span&gt;&lt;br /&gt;
    &lt;span style=&quot;color: #ff0000;&quot;&gt;&#039;my_module_completion&#039;&lt;/span&gt; =&lt;span style=&quot;color: #66cc66;&quot;&gt;&amp;gt;&lt;/span&gt; &lt;a href=&quot;http://www.php.net/array&quot;&gt;&lt;span style=&quot;color: #000066;&quot;&gt;array&lt;/span&gt;&lt;/a&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;(&lt;/span&gt;&lt;br /&gt;
      &lt;span style=&quot;color: #808080; font-style: italic;&quot;&gt;// the template filename, .tpl.php will be appended&lt;/span&gt;&lt;br /&gt;
      &lt;span style=&quot;color: #ff0000;&quot;&gt;&#039;template&#039;&lt;/span&gt; =&lt;span style=&quot;color: #66cc66;&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&quot;color: #ff0000;&quot;&gt;&#039;my_module_completion&#039;&lt;/span&gt;,&lt;br /&gt;
      &lt;span style=&quot;color: #808080; font-style: italic;&quot;&gt;// include order as a variable in the template&lt;/span&gt;&lt;br /&gt;
      &lt;span style=&quot;color: #ff0000;&quot;&gt;&#039;variables&#039;&lt;/span&gt; =&lt;span style=&quot;color: #66cc66;&quot;&gt;&amp;gt;&lt;/span&gt; &lt;a href=&quot;http://www.php.net/array&quot;&gt;&lt;span style=&quot;color: #000066;&quot;&gt;array&lt;/span&gt;&lt;/a&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #ff0000;&quot;&gt;&#039;order&#039;&lt;/span&gt; =&lt;span style=&quot;color: #66cc66;&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&quot;color: #000000; font-weight: bold;&quot;&gt;NULL&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;)&lt;/span&gt;,&lt;br /&gt;
    &lt;span style=&quot;color: #66cc66;&quot;&gt;)&lt;/span&gt;,&lt;br /&gt;
  &lt;span style=&quot;color: #66cc66;&quot;&gt;)&lt;/span&gt;;&lt;br /&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;}&lt;/span&gt; &lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Now that we have a theme implementation that is expecting an order variable, all that remains is to call it as the value for &lt;span class=&quot;geshifilter&quot;&gt;&lt;code class=&quot;php geshifilter-php&quot;&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;&#039;#markup&#039;&lt;/span&gt;&lt;/code&gt;&lt;/span&gt; in our output function above.&lt;/p&gt;
&lt;div class=&quot;geshifilter&quot;&gt;&lt;div class=&quot;drupal6 geshifilter-drupal6&quot; style=&quot;font-family:monospace;&quot;&gt;&lt;span style=&quot;color: #0000ff;&quot;&gt;$pane_form&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;[&lt;/span&gt;&lt;span style=&quot;color: #ff0000;&quot;&gt;&#039;message&#039;&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;]&lt;/span&gt; = &lt;a href=&quot;http://www.php.net/array&quot;&gt;&lt;span style=&quot;color: #000066;&quot;&gt;array&lt;/span&gt;&lt;/a&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #ff0000;&quot;&gt;&#039;#markup&#039;&lt;/span&gt; =&lt;span style=&quot;color: #66cc66;&quot;&gt;&amp;gt;&lt;/span&gt; &lt;a href=&quot;http://api.drupal.org/api/function/theme/6&quot;&gt;&lt;span style=&quot;color: #000066;&quot;&gt;theme&lt;/span&gt;&lt;/a&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #ff0000;&quot;&gt;&#039;my_module_completion&#039;&lt;/span&gt;, &lt;a href=&quot;http://www.php.net/array&quot;&gt;&lt;span style=&quot;color: #000066;&quot;&gt;array&lt;/span&gt;&lt;/a&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #ff0000;&quot;&gt;&#039;order&#039;&lt;/span&gt; =&lt;span style=&quot;color: #66cc66;&quot;&gt;&amp;gt;&lt;/span&gt; &lt;span style=&quot;color: #0000ff;&quot;&gt;$order&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;)&lt;/span&gt;&lt;span style=&quot;color: #66cc66;&quot;&gt;)&lt;/span&gt;;&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;From here simply create the &lt;span class=&quot;geshifilter&quot;&gt;&lt;code class=&quot;php geshifilter-php&quot;&gt;my_module_completion&lt;span style=&quot;color: #339933;&quot;&gt;.&lt;/span&gt;tpl&lt;span style=&quot;color: #339933;&quot;&gt;.&lt;/span&gt;php&lt;/code&gt;&lt;/span&gt; file and theme away!  The template will have our order information exposed as the php variable &lt;span class=&quot;geshifilter&quot;&gt;&lt;code class=&quot;php geshifilter-php&quot;&gt;&lt;span style=&quot;color: #000088;&quot;&gt;$order&lt;/span&gt;&lt;/code&gt;&lt;/span&gt; allowing us to output whatever order information we would like.  This is probably a good time to note, that the &lt;span class=&quot;geshifilter&quot;&gt;&lt;code class=&quot;php geshifilter-php&quot;&gt;&lt;span style=&quot;color: #000088;&quot;&gt;$order&lt;/span&gt;&lt;/code&gt;&lt;/span&gt; variable very well may not be sufficient (it wasn&#039;t for us).  It contains mostly keys to fetch other bits of data about the order.  In our actual implementation we wound up loading the line item (our implementation only allowed one), and some customer information.  This can easily be done from the output function you define in &lt;span class=&quot;geshifilter&quot;&gt;&lt;code class=&quot;php geshifilter-php&quot;&gt;hook_commerce_checkout_pane_info_alter&lt;/code&gt;&lt;/span&gt; and passed to the template exactly as we did the order variable in this example.&lt;/p&gt;
&lt;p&gt;&lt;em&gt;I admit that this is bordering on being somewhat hackish.&lt;/em&gt;  I don&#039;t think I would take this approach if the Commerce implementation was more complex.  If that were the case a better approach may be to &lt;a href=&quot;http://api.drupalcommerce.org/api/Drupal%20Commerce/sites%21all%21modules%21commerce%21modules%21checkout%21commerce_checkout.api.php/function/hook_commerce_checkout_pane_info/DC&quot;&gt;create a custom checkout pane&lt;/a&gt;  with the output you would like, assign it to the appropriate checkout pages, and leave the poor checkout completion pane alone.  However, in the interest of time and ease in satisfying a theme requirement for a relatively small site, this method worked like a charm.  Further, I don&#039;t believe that anything has been obfuscated.  With some light commenting it should be apparent to anyone who reviews this code, exactly what is going on.  With that in mind, take this method as a handy &lt;em&gt;trick&lt;/em&gt; if you need to quickly and drastically rework how the checkout completion pane is displayed.&lt;/p&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;</description>
 <pubDate>Sun, 12 Aug 2012 18:25:26 +0000</pubDate>
 <dc:creator>rho</dc:creator>
 <guid isPermaLink="false">161 at http://theoleschool.com</guid>
</item>
</channel>
</rss>
